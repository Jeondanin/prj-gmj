<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	<mapper namespace="com.gmj.prj.vo.GmjCboard">
		<select id="selectCboardList" resultType="com.gmj.prj.vo.GmjCboard">
			select gmjcboardno, gmjcboardtitle,gmjusername,gmjcboard.credat,gmjcboardcnt from gmjcboard,gmjclient
			 where gmjcboard.gmjclientno=gmjclient.gmjUserNo order by gmjcboard.credat, gmjcboardno;
		</select>
		<select id="selectCboardListUser" resultType="com.gmj.prj.vo.GmjCboard">
			select gmjcboardno, gmjcboardtitle,gmjusername,date_format(gmjcboard.credat,"%Y-%m-%d") as credat,gmjcboardcnt from gmjcboard,gmjclient
			 where gmjcboard.gmjclientno=gmjclient.gmjUserNo order by gmjcboard.credat desc, gmjcboardno desc limit #{bundle} OFFSET #{OFFSET};
		</select>
		<select id="selectCboard" resultType="com.gmj.prj.vo.GmjCboard">
		select gmjcboardno, gmjcboardtitle,gmjusername,gmjcboarddesc,date_format(gmjcboard.credat,"%Y-%m-%d") as credat,gmjcboardcnt from gmjcboard,gmjclient
			 where gmjcboardno= #{gmjcboardno} and gmjcboard.gmjclientno=gmjclient.gmjUserNo 
	
		</select>
		<insert id="insertCboard" >
			insert into gmjcboard(gmjcboardtitle,gmjcboarddesc,gmjclientno,credat,moddat,gmjcboardcnt)
			values(#{gmjcboardtitle},#{gmjcboardtitle},1,now(),now(),0);
		</insert>
		
		<insert id="insertReply" >
			INSERT INTO `bdi`.`gmjreply` (`gmjcboardno`, `gmjuserno`, `gmjreplydesc`, `credat`, `moddat`) 
			VALUES (#{gmjcboardno}, #{gmjuserno}, #{gmjreplydesc}, now(), now());
		</insert>
		<select id="selectReply" resultType="Map" >
			select distinct gmjreply.* from gmjreply,gmjclient,gmjcboard where gmjreply.gmjcboardno=#{gmjcboardno};
		</select>
		
		
		
	</mapper>